{% extends "base.html" %}
{% block title %}Register{% endblock %}
{% block extra_css %}
<style>
    .register-box { max-width: 500px; margin: 3rem auto; background: var(--surface); padding: 2.5rem; border-radius: 12px; box-shadow: var(--shadow); }
    .register-box h2 { margin-bottom: 1.5rem; color: var(--primary); text-align: center; }
    .form-group { margin-bottom: 1.5rem; }
    .form-group label { display: block; margin-bottom: 0.5rem; font-weight: 600; }
    .form-group input, .form-group select { width: 100%; padding: 0.75rem; border: 2px solid var(--border); border-radius: 6px; font-size: 1rem; }
    .form-group input:focus, .form-group select:focus { outline: none; border-color: var(--primary); }
    .password-hint { font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.5rem; }
    .btn-block { width: 100%; }
    .links { text-align: center; margin-top: 1.5rem; color: var(--text-secondary); }
    .links a { color: var(--primary); text-decoration: none; font-weight: 600; }
</style>
{% endblock %}
{% block content %}
<div class="register-box">
    <h2>üîê Create Account</h2>
    <form id="registerForm">
        <div class="form-group">
            <label for="username">Username</label>
            <input type="text" id="username" required minlength="3" placeholder="Enter username">
        </div>
        <div class="form-group">
            <label for="email">Email</label>
            <input type="email" id="email" required placeholder="your.email@example.com">
        </div>
        <div class="form-group">
            <label for="password">Password</label>
            <input type="password" id="password" required minlength="8" placeholder="Enter strong password">
            <div class="password-hint">8+ characters, uppercase, lowercase, number, special character</div>
        </div>
        <div class="form-group">
            <label for="confirmPassword">Confirm Password</label>
            <input type="password" id="confirmPassword" required placeholder="Re-enter password">
        </div>
        <div class="form-group">
            <label for="role">Account Type</label>
            <select id="role">
                <option value="User">User</option>
                <option value="Admin">Admin (Demo)</option>
            </select>
        </div>
        <button type="submit" class="btn btn-primary btn-block">Register</button>
    </form>
    <div class="links">Already have an account? <a href="/login">Login here</a></div>
</div>
{% endblock %}
{% block extra_js %}
<script>
    document.getElementById('registerForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        const password = document.getElementById('password').value;
        const confirmPassword = document.getElementById('confirmPassword').value;
        if (password !== confirmPassword) {
            showAlert('Passwords do not match!', 'error');
            return;
        }
        const response = await fetch('/api/register', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({
                username: document.getElementById('username').value,
                email: document.getElementById('email').value,
                password: password,
                role: document.getElementById('role').value
            })
        });
        const data = await response.json();
        if (response.ok) {
            showAlert('Registration successful! Redirecting...', 'success');
            setTimeout(() => { window.location.href = '/login'; }, 2000);
        } else {
            showAlert(data.error || 'Registration failed', 'error');
        }
    });
</script>
{% endblock %}
